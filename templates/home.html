<!DOCTYPE html><html lang="en">{% load static %}<head>    <title>Home</title>    <meta charset="utf-8">    <meta name="viewport" content="width=device-width, initial-scale=1">    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"></head><body><nav class="navbar navbar-expand-lg navbar-light bg-light">    <img src="/static/images/faircare_logo.png" alt="Logo">  <a class="navbar-brand" href="#">FairCare</a>  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">    <span class="navbar-toggler-icon"></span>  </button>  <div class="collapse navbar-collapse" id="navbarSupportedContent">    <ul class="navbar-nav mr-auto">      <li class="nav-item">        <a class="nav-link" href="/logout">Logout</a>      </li>    </ul>  </div></nav><div> <form action="{% url 'home' %}" method="post">                {% csrf_token %}                {% for field in medication_submit_form %}                <div class="form-group">                  {{ field.label_tag }}<br>                  {{ field }}                  {% if field.help_text %}<br>                  <small style="color: grey">{{ field.help_text }}</small>                  {% endif %}                  {% for error in field.errors %}                  <div >                    {{ error }}                  </div>                  {% endfor %}                </div>                {% endfor %}                <div class="mx-auto text-center">                  <input type="submit"  value="Submit Medication Data" class="btn btn-primary">                </div>              </form><div>    {% if messages %}<ul class="messages">    {% for message in messages %}    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>    {% endfor %}</ul>{% endif %}</div>    <hr><form action="{% url 'home' %}" method="post">                {% csrf_token %}                {% for field in medication_view_form %}                <div class="form-group">                  {{ field.label_tag }}<br>                  {{ field }}                  {% if field.help_text %}<br>                  <small style="color: grey">{{ field.help_text }}</small>                  {% endif %}                  {% for error in field.errors %}                  <div >                    {{ error }}                  </div>                  {% endfor %}                </div>                {% endfor %}                <div class="mx-auto text-center">                  <input type="submit"  value="View Medication Visualization" class="btn btn-primary">                </div>              </form></div><div id="vis">\<h2>Average Price By State in USD</h2></div><script src="https://d3js.org/d3.v4.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.7.1/d3-tip.min.js"></script><script type="text/javascript">//Width and height of mapvar width = 960;var height = 500;var lowColor = '#f5c6c6'var highColor = '#bc2a66'// D3 Projectionvar projection = d3.geoAlbersUsa()  .translate([width / 2, height / 2])  .scale([1000]);// Define path generatorvar path = d3.geoPath()  .projection(projection);var svg = d3.select("body")  .append("svg")  .attr("width", width)  .attr("height", height);var tooltipmap = d3.map();d3.json("/medicine_data?medication_view={{ medication_view }}", function(data) {	var dataArray = [];	for (var d = 0; d < data.length; d++) {	       data[d].price = +data[d].price;	tooltipmap.set(data[d].state, data[d]);		dataArray.push(parseFloat(data[d].price))	}	var minVal = d3.min(dataArray)	var maxVal = d3.max(dataArray)	var ramp = d3.scaleLinear().domain([minVal,maxVal]).range([lowColor,highColor])  d3.json("/static/json/us-states.json", function(json) {    // Loop through each state data value in the .csv file    for (var i = 0; i < data.length; i++) {      // Grab State Name      var dataState = data[i].state;      // Grab data value      var dataValue = data[i].price;      for (var j = 0; j < json.features.length; j++) {        var jsonState = json.features[j].properties.name;        if (dataState == jsonState) {          json.features[j].properties.price = dataValue;          break;        }      }    }     var tip = d3.tip()  .attr('class', 'd3-tip')  .offset([-5, 0])  .html(function(d) {    var dataRow = tooltipmap.get(d.properties.name);       if (dataRow) {           return "Average Price" + ":  $" + dataRow.price;       } else {           return d.properties.name + ": No data.";       }  })svg.call(tip);    svg.selectAll("path")      .data(json.features)      .enter()      .append("path")      .attr("d", path)        .on('mouseover', tip.show)        .on('mouseout', tip.hide)      .style("stroke", "#fff")      .style("stroke-width", "2")      .style("fill", function(d) { return ramp(d.properties.price) });		// add a legend		var w = 140, h = 300;		var key = d3.select("body")			.append("svg")			.attr("width", w)			.attr("height", h)			.attr("class", "legend");		var legend = key.append("defs")			.append("svg:linearGradient")			.attr("id", "gradient")			.attr("x1", "100%")			.attr("y1", "0%")			.attr("x2", "100%")			.attr("y2", "100%")			.attr("spreadMethod", "pad");		legend.append("stop")			.attr("offset", "0%")			.attr("stop-color", highColor)			.attr("stop-opacity", 1);		legend.append("stop")			.attr("offset", "100%")			.attr("stop-color", lowColor)			.attr("stop-opacity", 1);		key.append("rect")			.attr("width", w - 100)			.attr("height", h)			.style("fill", "url(#gradient)")			.attr("transform", "translate(0,10)");		var y = d3.scaleLinear()			.range([h, 0])			.domain([minVal, maxVal]);		var yAxis = d3.axisRight(y);		key.append("g")			.attr("class", "y axis")			.attr("transform", "translate(40,10)")			.call(yAxis)  });});</script></body></html>